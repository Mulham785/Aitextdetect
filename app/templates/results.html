{% extends "base.html" %}

{% block title %}Analysis Results - AI Text Analysis{% endblock %}

{% block content %}
    <h2>Analysis Results</h2>
    
    <div class="text-preview">
        <h3>Text Information</h3>
        <p><strong>Source:</strong> {{ text.source }}</p>
        <p><strong>Topic:</strong> {{ text.topic }}</p>
        <div class="content-preview">
            <p>{{ text.content[:300] }}{% if text.content|length > 300 %}...{% endif %}</p>
        </div>
    </div>
    
    {% if analysis %}
    <div class="results">
        <h3>Statistical Analysis</h3>

        <div class="metrics-grid">
            <div class="metric">
                <h4>Perplexity</h4>
                <p class="value">{{ "%.2f"|format(analysis.perplexity) }}</p>
                <p>Measures text predictability. Lower values indicate more predictable text, common in AI-generated content.</p>
            </div>

            <div class="metric">
                <h4>Burstiness</h4>
                <p class="value">{{ "%.2f"|format(analysis.burstiness) }}</p>
                <p>Measures variation in sentence structure. Lower values indicate more uniform structure, common in AI-generated content.</p>
            </div>

            <div class="metric">
                <h4>AI Content Proportion</h4>
                <div class="progress-bar">
                    <div class="progress" style="width: {{ analysis.ai_proportion * 100 }}%"></div>
                </div>
                <p class="value">{{ "%.1f"|format(analysis.ai_proportion * 100) }}%</p>
                <p>Estimated proportion of AI-generated content based on statistical metrics.</p>
            </div>

            <div class="metric">
                <h4>AI Document Similarity</h4>
                <div class="progress-bar">
                    <div class="progress" style="width: {{ analysis.ai_similarity * 100 }}%"></div>
                </div>
                <p class="value">{{ "%.1f"|format(analysis.ai_similarity * 100) }}%</p>
                <p>Similarity with AI documents in the database. Higher values indicate more AI-like content.</p>
            </div>

            <div class="metric">
                <h4>Human Document Similarity</h4>
                <div class="progress-bar">
                    <div class="progress" style="width: {{ analysis.human_similarity * 100 }}%"></div>
                </div>
                <p class="value">{{ "%.1f"|format(analysis.human_similarity * 100) }}%</p>
                <p>Similarity with human documents in the database. Higher values indicate more human-like content.</p>
            </div>

            <div class="metric">
                <h4>Overall AI Score</h4>
                <div class="progress-bar">
                    <div class="progress" style="width: {{ (analysis.ai_proportion * 0.6 + analysis.ai_similarity * 0.4) * 100 }}%"></div>
                </div>
                <p class="value">{{ "%.1f"|format((analysis.ai_proportion * 0.6 + analysis.ai_similarity * 0.4) * 100) }}%</p>
                <p>Combined score indicating likelihood of AI-generated content.</p>
            </div>
        </div>
    </div>

    <div class="comparison-summary">
        <h3>Comparison Summary</h3>
        <div class="summary-grid">
            <div class="summary-item">
                <h4>Comparison with AI Documents</h4>
                <p>{{ "%.1f"|format(analysis.ai_similarity * 100) }}% similar</p>
                <div class="progress-bar">
                    <div class="progress" style="width: {{ analysis.ai_similarity * 100 }}%"></div>
                </div>
            </div>

            <div class="summary-item">
                <h4>Comparison with Human Documents</h4>
                <p>{{ "%.1f"|format(analysis.human_similarity * 100) }}% similar</p>
                <div class="progress-bar">
                    <div class="progress" style="width: {{ analysis.human_similarity * 100 }}%"></div>
                </div>
            </div>

            <div class="summary-item">
                <h4>Overall AI Likelihood</h4>
                <p>{{ "%.1f"|format((analysis.ai_proportion * 0.6 + analysis.ai_similarity * 0.4) * 100) }}%</p>
                <div class="progress-bar">
                    <div class="progress" style="width: {{ (analysis.ai_proportion * 0.6 + analysis.ai_similarity * 0.4) * 100 }}%"></div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <div class="actions">
        <a href="{{ url_for('detect') }}" class="button">Analyze Another Text</a>
        <a href="{{ url_for('index') }}" class="button">Return Home</a>
    </div>
{% endblock %}